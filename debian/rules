#!/usr/bin/make -f

export DEB_BUILD_MAINT_OPTIONS = hardening=+all
export CARGO_HOME = $(CURDIR)/debian/cargo_home
export CARGO_PROFILE_RELEASE_DEBUG=2

%:
	dh $@

override_dh_auto_configure:
	dh_auto_configure

override_dh_auto_build:
	cargo build --release -p fastboop-cli

override_dh_auto_install:
	dh_auto_install
	install -Dm0755 target/release/fastboop-cli \
		debian/fastboop/usr/bin/fastboop

override_dh_installman:
	help2man -N -n "Ephemeral Linux boot tool for USB-enabled pocket computers" \
		-o debian/fastboop.1 ./target/release/fastboop-cli
	dh_installman
